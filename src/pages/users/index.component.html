<panel-breadcrumb></panel-breadcrumb>
<d-table [data]="data">
  <ng-template dTableTemplate="caption">
    <d-button icon="far fa-plus" (click)="showDialog(formTpl, {title: 'افزودن کاربر جدید'})">افزودن کاربر جدید</d-button>
  </ng-template>
  <ng-template dTableTemplate="header,footer">
    <tr>
      <th>#</th>
      <th>نام</th>
      <th>نام کاربری</th>
      <th>شماره موبایل</th>
      <th>ایمیل</th>
      <th class="text-align-center" width="10">ورود دو مرحله ای</th>
      <th class="text-align-center" width="10">نیاز به تغییر رمز</th>
      <th class="text-align-center" width="10">فعال</th>
      <th class="text-align-center" width="10">عملیات</th>
    </tr>
  </ng-template>
  <ng-template dTableTemplate="body" let-item let-index="index">
    <tr>
      <td>{{ index }}</td>
      <td>{{ item.name }}</td>
      <td>{{ item.username }}</td>
      <td>{{ item.cellphone }}</td>
      <td>{{ item.email }}</td>
      <td>
        <div class="flex-center">
          <span [ngClass]="(item.isTwoFactorAuthenticationEnable ? 'color-success' : 'color-danger')">
            {{ item.isTwoFactorAuthenticationEnable ? 'بله' : 'خیر' }}
          </span>
        </div>
      </td>
      <td>
        <div class="flex-center">
          <span [ngClass]="(item.needResetPassword ? 'color-success' : 'color-danger')">
            {{ item.needResetPassword ? 'بله' : 'خیر' }}
          </span>
        </div>
      </td>
      <td>
        <div class="flex-center">
          <span [ngClass]="(item.isActive ? 'color-success' : 'color-danger')">{{ item.isActive ? 'بله' : 'خیر' }}</span>
        </div>
      </td>
      <td>
        <div class="flex-center flex-gap-3">
          <ng-container *ngFor="let option of userOptions">
            <d-button mode="text" [color]="option.color" [icon]="option.icon"
                      (click)="showDialogByComponent(option.component, {user:item}, option.dialog)"></d-button>
          </ng-container>
          <d-button mode="text" color="secondary" icon="far fa-shield-halved"
                    (click)="showDialog(accessTpl, {title: 'دسترسی کاربر ' + item.name, context: item})"></d-button>
          <d-button mode="text" color="warning" icon="far fa-pen-to-square"
                    (click)="showDialog(formTpl, {title: 'ویرایش کاربر ' + item.name, context: item})"></d-button>
          <d-button mode="text" color="danger" icon="far fa-trash-can" (click)="remove(item)"></d-button>
        </div>
      </td>
    </tr>
  </ng-template>
</d-table>

<ng-template #formTpl let-dialog let-item="context">
  <app-form [model]="item" (onComplete)="dialog.close()"></app-form>
</ng-template>

<ng-template #accessTpl let-dialog let-item="context">
  <app-access [model]="item" (onComplete)="dialog.close()"></app-access>
</ng-template>
